<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cyber Defense Lab</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
</head>
<body>

    <h1 style="margin-bottom: 5px;">üõ°Ô∏è Cyber Defense Lab</h1>
    <div style="color: var(--neon-purple); font-weight: bold; letter-spacing: 10px; margin-bottom: 40px; text-transform: uppercase; font-size: 0.8rem; text-shadow: 0 0 5px var(--neon-purple);">HACKING SAFETY</div>

    <div class="container">
        <!-- DASHBOARD -->
        <div id="dashboard" class="dashboard-grid active">
            <div class="module-card" onclick="openGame('phishing')">
                <span class="icon">üìß</span>
                <h3>Phish or Legit?</h3>
                <p>Detect sophisticated social engineering.</p>
            </div>
            <div class="module-card" onclick="openGame('threathunter')">
                <span class="icon">üïµÔ∏è‚Äç‚ôÇÔ∏è</span>
                <h3>Threat Hunter</h3>
                <p>Terminate malicious system processes.</p>
            </div>
            <div class="module-card" onclick="openGame('crypto')">
                <span class="icon">üîê</span>
                <h3>Crypto Lab</h3>
                <p>Decode secret historical messages.</p>
            </div>
            <div class="module-card" onclick="openGame('password')">
                <span class="icon">üîë</span>
                <h3>Password Vault</h3>
                <p>Test brute-force cracking speeds.</p>
            </div>
            <div class="module-card" onclick="openGame('quiz')">
                <span class="icon">üõ°Ô∏è</span>
                <h3>Security Trivia</h3>
                <p>Challenge your general knowledge.</p>
            </div>
            <div class="module-card" onclick="openGame('social')">
                <span class="icon">üí¨</span>
                <h3>Social Engineering</h3>
                <p>Identify human manipulation tactics.</p>
            </div>
            <div class="module-card" onclick="openGame('forensics')">
                <span class="icon">üîç</span>
                <h3>Digital Forensics</h3>
                <p>Audit system for data leaks.</p>
            </div>
        </div>

        <!-- GAME ARENA -->
        <div id="game-arena" class="game-arena">
            <button class="btn-nav" onclick="closeGame()">‚Üê Return to Dashboard</button>

            <!-- MISSION INTRO -->
            <div id="game-intro" class="game-container hidden" style="text-align: center;">
                <h2 id="intro-title" style="color: var(--neon-blue); margin-bottom: 20px;">Mission Briefing</h2>
                <div id="intro-icon" style="font-size: 4rem; margin-bottom: 20px;"></div>
                <p id="intro-description" style="font-size: 1.1rem; line-height: 1.6; margin: 30px 0; color: var(--text); opacity: 0.9;"></p>
                <button id="start-mission-btn" class="btn-action btn-safe">Start Mission</button>
            </div>

            <!-- PHISHING -->
            <div id="game-phishing" class="game-container hidden">
                <h2 style="color: var(--neon-blue);">üìß Inbox Defender</h2>
                <div class="email-client">
                    <div class="email-sidebar">
                        <div class="email-folder active">üì• Inbox</div>
                        <div class="email-folder">üì§ Sent</div>
                        <div class="email-folder">üìÅ Drafts</div>
                        <div class="email-folder">üóëÔ∏è Trash</div>
                    </div>
                    <div id="email-display" class="email-content"></div>
                </div>
                <div class="btn-group">
                    <button id="phish-report-btn" class="btn-action btn-phish" onclick="checkPhish(true)">Report Phish</button>
                    <button id="phish-safe-btn" class="btn-action btn-safe" onclick="checkPhish(false)">Mark as Safe</button>
                    <button id="phish-next-btn" class="btn-action btn-nav hidden" onclick="loadEmail()" style="margin-bottom: 0;">Next Email</button>
                </div>
                <p id="phish-feedback" style="text-align:center; min-height: 4rem; margin-top:20px; font-weight: bold;"></p>
                <div id="phish-summary" class="hidden" style="text-align:center; margin-top: 20px;">
                    <h3 style="color: var(--success);">SIMULATION COMPLETE</h3>
                    <p>You have audited the entire inbox.</p>
                    <button class="btn-nav" onclick="closeGame()">Return to Dashboard</button>
                </div>
                <div style="text-align:center; font-size: 1.2rem;">Security Level: <span id="score">0</span> / 15</div>
            </div>

            <!-- THREAT HUNTER -->
            <div id="game-threathunter" class="game-container hidden">
                <h2 style="color: var(--neon-blue);">Threat Hunter</h2>
                <div style="display: flex; justify-content: space-between; margin-bottom: 15px;">
                    <span>System Stability: <span id="stability-text" style="font-weight:bold;">100%</span></span>
                    <span>Threats Neutralized: <span id="hunter-score" style="font-weight:bold;">0</span></span>
                </div>
                <div style="height: 10px; background: #000; border-radius: 5px; margin-bottom: 25px; overflow: hidden; border: 1px solid var(--border);">
                    <div id="stability-fill" style="height:100%; width:100%; background: var(--success); transition: 0.3s;"></div>
                </div>
                <div id="process-list-container" style="background: #050505; border-radius: 12px; border: 1px solid var(--border); height: 350px; overflow-y: auto;">
                    <table style="width: 100%; border-collapse: collapse; text-align: left;">
                        <thead style="background: #101020; position: sticky; top: 0; z-index: 10;">
                            <tr>
                                <th style="padding: 15px; border-bottom: 1px solid var(--border);">PID</th>
                                <th style="padding: 15px; border-bottom: 1px solid var(--border);">Process Name</th>
                                <th style="padding: 15px; border-bottom: 1px solid var(--border);">Path</th>
                                <th style="padding: 15px; border-bottom: 1px solid var(--border);">Action</th>
                            </tr>
                        </thead>
                        <tbody id="process-list-body"></tbody>
                    </table>
                </div>
                <div id="hunter-game-over" class="hidden" style="text-align: center; margin-top: 30px;">
                    <h3 style="color: var(--danger);">SYSTEM COMPROMISED</h3>
                    <button class="btn-action btn-safe" onclick="startHunter()">Reboot & Retry</button>
                </div>
                <div id="hunter-victory" class="hidden" style="text-align: center; margin-top: 30px;">
                    <h3 style="color: var(--success);">MISSION ACCOMPLISHED</h3>
                    <p>You have successfully secured the system perimeter.</p>
                    <button class="btn-nav" onclick="closeGame()">Return to Dashboard</button>
                </div>
            </div>

            <!-- CRYPTO -->
            <div id="game-crypto" class="game-container hidden">
                <h2 style="color: var(--neon-blue);">Crypto Lab: Level <span id="crypto-level">1</span></h2>
                <div class="terminal-box">
                    <div id="encrypted-display" style="font-size: 2.5rem; text-align: center; margin: 40px 0; color: var(--neon-purple); letter-spacing: 5px; font-weight: bold;"></div>
                    <div style="max-width: 500px; margin: 0 auto;">
                        <div style="display: flex; justify-content: space-between;">
                            <span>Cipher Shift:</span>
                            <span id="shift-value" style="color: var(--neon-blue); font-weight: bold;">0</span>
                        </div>
                        <input type="range" id="shift-slider" min="0" max="25" value="0" oninput="updateCrypto()">
                        <div style="margin-top:20px; border-top: 1px solid var(--border); padding-top:20px;">
                            <span>Decrypted Preview:</span>
                            <div id="decrypted-preview" style="font-size: 1.5rem; color: var(--success); margin-top: 10px; min-height: 1.8rem;"></div>
                        </div>
                    </div>
                </div>
                <p id="crypto-feedback" style="text-align:center; height: 1.5rem; margin-top: 25px; font-weight: bold; font-size: 1.2rem;"></p>
            </div>

            <!-- PASSWORD -->
            <div id="game-password" class="game-container hidden">
                <h2 style="color: var(--neon-blue);">üîë Password Vault</h2>
                <div class="terminal-box" style="margin-top: 20px;">
                    <div style="color: var(--neon-blue); margin-bottom: 20px; font-family: monospace;">[SYSTEM]: ENTER ACCESS KEY FOR ENTROPY ANALYSIS...</div>
                    <input type="text" id="pw-input" placeholder="ACCESS_KEY_HERE" oninput="calculatePassword()" style="font-family: monospace; border: 1px dashed var(--neon-blue);">
                    <div id="pw-result" style="text-align:center; margin-top: 30px; font-size: 1.5rem; font-weight: bold; font-family: monospace;">READY</div>
                </div>
                <div style="margin-top: 40px; padding: 20px; background: rgba(0,242,255,0.05); border: 1px solid var(--border); border-radius: 8px; font-size: 0.9rem;">
                    <strong>DEFENSIVE ADVISORY:</strong> Use long passphrases with varied character sets to maximize brute-force resistance.
                </div>
            </div>

            <!-- QUIZ -->
            <div id="game-quiz" class="game-container hidden">
                <h2 style="color: var(--neon-blue);">Security Trivia</h2>
                <p id="quiz-question" style="font-size: 1.2rem; margin-bottom: 30px; line-height: 1.6;"></p>
                <div id="quiz-options" style="display: grid; gap: 15px;"></div>
                <p id="quiz-feedback" style="text-align:center; margin-top: 30px; min-height: 2rem; font-weight: bold; font-size: 1.2rem;"></p>
                <div id="quiz-summary" class="hidden" style="text-align:center; margin-top: 20px;">
                    <h3 style="color: var(--success);">QUIZ COMPLETE</h3>
                    <p id="quiz-final-score"></p>
                    <button class="btn-nav" onclick="closeGame()">Return to Dashboard</button>
                </div>
            </div>

            <!-- SOCIAL ENGINEERING -->
            <div id="game-social" class="game-container hidden">
                <h2 style="color: var(--neon-pink);">Social Engineering</h2>
                <div class="chat-container">
                    <div class="chat-sidebar">
                        <div style="font-size: 0.8rem; margin-bottom: 15px; opacity: 0.6;">CONVERSATIONS</div>
                        <div style="padding: 10px; background: rgba(0, 242, 255, 0.1); border-radius: 5px; margin-bottom: 5px;">Sarah_HR</div>
                        <div style="padding: 10px; opacity: 0.5;">Mike_IT</div>
                        <div style="padding: 10px; opacity: 0.5;">Exec_Admin</div>
                    </div>
                    <div class="chat-main">
                        <div id="chat-history" class="chat-history"></div>
                        <div id="chat-controls" class="btn-group">
                            <button class="btn-action btn-safe" onclick="handleChatAction(false)">Legitimate</button>
                            <button class="btn-action btn-phish" onclick="handleChatAction(true)">Suspicious</button>
                        </div>
                        <div id="briefing-overlay" class="modal hidden">
                            <h3 id="briefing-title">ANALYSIS RESULT</h3>
                            <p id="briefing-text" style="margin: 20px 0; line-height: 1.6;"></p>
                            <button class="btn-nav" onclick="nextChatScenario()" style="margin-bottom:0;">Continue Audit</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- FORENSICS -->
            <div id="game-forensics" class="game-container hidden">
                <h2 style="color: var(--neon-blue);">Digital Forensics</h2>
                <div class="virtual-desktop">
                    <!-- LEAKS/THREATS -->
                    <div id="icon-sticky" class="desktop-icon" onclick="inspectDesktopItem('sticky')" style="top: 20px; left: 20px;"><span style="font-size:2rem;">üìù</span><div class="icon-label">secrets.txt</div></div>
                    <div id="icon-config" class="desktop-icon" onclick="inspectDesktopItem('config')" style="top: 20px; left: 120px;"><span style="font-size:2rem;">‚öôÔ∏è</span><div class="icon-label">env.config</div></div>
                    <div id="icon-logs" class="desktop-icon" onclick="inspectDesktopItem('logs')" style="top: 120px; left: 20px;"><span style="font-size:2rem;">üìä</span><div class="icon-label">access.log</div></div>
                    <div id="icon-trash" class="desktop-icon" onclick="inspectDesktopItem('trash')" style="bottom: 20px; right: 20px;"><span style="font-size:2rem;">üóëÔ∏è</span><div class="icon-label">Trash</div></div>
                    <div id="icon-trojan" class="desktop-icon" onclick="inspectDesktopItem('trojan')" style="top: 120px; left: 120px;"><span style="font-size:2rem;">üëæ</span><div class="icon-label">system_patch.exe</div></div>
                    <div id="icon-keylogger" class="desktop-icon" onclick="inspectDesktopItem('keylogger')" style="top: 220px; left: 20px;"><span style="font-size:2rem;">üï∑Ô∏è</span><div class="icon-label">lib_key.dll</div></div>

                    <!-- NORMAL ITEMS -->
                    <div id="icon-photos" class="desktop-icon" onclick="inspectDesktopItem('photos')" style="top: 20px; left: 220px;"><span style="font-size:2rem;">üñºÔ∏è</span><div class="icon-label">Vacation.jpg</div></div>
                    <div id="icon-music" class="desktop-icon" onclick="inspectDesktopItem('music')" style="top: 120px; left: 220px;"><span style="font-size:2rem;">üéµ</span><div class="icon-label">Song.mp3</div></div>
                    <div id="icon-docs" class="desktop-icon" onclick="inspectDesktopItem('docs')" style="bottom: 20px; left: 20px;"><span style="font-size:2rem;">üìÑ</span><div class="icon-label">Report.pdf</div></div>
                    <div id="icon-browser" class="desktop-icon" onclick="inspectDesktopItem('browser')" style="top: 220px; left: 120px;"><span style="font-size:2rem;">üåê</span><div class="icon-label">Browser</div></div>

                    <div id="forensics-modal" class="modal hidden">
                        <h3 id="modal-title">File Inspector</h3>
                        <div id="modal-content" style="background:#000; padding:20px; margin:20px 0; border-radius:8px; font-family:monospace; border:1px solid var(--border); white-space:pre-wrap;"></div>
                        <button class="btn-nav" onclick="closeForensicsModal()" style="margin-bottom:0;">Close File</button>
                    </div>

                    <div id="forensics-summary" class="modal hidden">
                        <h2 style="color: var(--success);">FORENSICS COMPLETE</h2>
                        <p>All critical security artifacts have been recovered from the host machine.</p>
                        <ul style="text-align: left; line-height: 2;">
                            <li>Unencrypted Credentials Extracted</li>
                            <li>Hardcoded API Secrets Identified</li>
                            <li>Brute Force Logs Verified</li>
                            <li>Deleted Files Recovered</li>
                        </ul>
                        <button class="btn-nav" onclick="closeGame()" style="margin-bottom:0;">Submit Report</button>
                    </div>
                </div>
                <div style="text-align:center; margin-top:20px; font-size: 1.1rem;">
                    Security Risks Identified: <span id="leaks-found-count" style="color: var(--neon-blue); font-weight: bold;">0</span> / 6
                </div>
            </div>

        </div>
    </div>

    <footer>¬© 2026 Cyber Defense Training Lab | v4.2.0 Stable</footer>

    <script src="{{ url_for('static', filename='js/games.js') }}"></script>
</body>
</html>
